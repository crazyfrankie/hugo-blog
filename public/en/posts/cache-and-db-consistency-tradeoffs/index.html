<!DOCTYPE html>
<html lang="en-US">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Cache and DB - Consistency Tradeoffs - Crazyfrank&#39;s Blog</title><meta name="Description" content="Crazyfrank&#39;s English Blog"><meta property="og:url" content="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/">
  <meta property="og:site_name" content="Crazyfrank&#39;s Blog">
  <meta property="og:title" content="Cache and DB - Consistency Tradeoffs">
  <meta property="og:description" content="Today we talk about bypass caching strategies.
Introduction to Concepts Generally speaking we introduce caching in our business, which involves three ways of manipulating the database and caching:
Read-through: application reads data. it checks Redis. a hit is returned. If there is no hit, check MySQL. Fetch the data from MySQL and write it to Redis. Return the data. Write through: The application updates the data. Code executes simultaneously (or in the same transaction): Update the MySQL database. Update (or invalidate) the corresponding cache in Redis. Bypass the cache: Read operations: Use the “read-through” policy. Cache Hit -&gt; return cached data. Cache Miss -&gt; Read from DB, backfill Cache and return. Write operation: first update DB, then delete (invalidate) cache. This is the essence of the “bypass cache” strategy - “update the database first, then delete the cache”. For read-through from the above introduction can also be seen that it is not used alone, and write-through, there is no middleware support for simultaneous operation of the database, so generally do not use, so the most daily use of the third way: bypass caching!">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-11T10:00:00+08:00">
    <meta property="article:modified_time" content="2025-09-11T10:00:00+08:00">
    <meta property="article:tag" content="Caching">
    <meta property="article:tag" content="System Design">
    <meta property="article:tag" content="Architecture Design">
    <meta property="og:image" content="http://localhost:1313/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/logo.png">
  <meta name="twitter:title" content="Cache and DB - Consistency Tradeoffs">
  <meta name="twitter:description" content="Today we talk about bypass caching strategies.
Introduction to Concepts Generally speaking we introduce caching in our business, which involves three ways of manipulating the database and caching:
Read-through: application reads data. it checks Redis. a hit is returned. If there is no hit, check MySQL. Fetch the data from MySQL and write it to Redis. Return the data. Write through: The application updates the data. Code executes simultaneously (or in the same transaction): Update the MySQL database. Update (or invalidate) the corresponding cache in Redis. Bypass the cache: Read operations: Use the “read-through” policy. Cache Hit -&gt; return cached data. Cache Miss -&gt; Read from DB, backfill Cache and return. Write operation: first update DB, then delete (invalidate) cache. This is the essence of the “bypass cache” strategy - “update the database first, then delete the cache”. For read-through from the above introduction can also be seen that it is not used alone, and write-through, there is no middleware support for simultaneous operation of the database, so generally do not use, so the most daily use of the third way: bypass caching!">
<meta name="application-name" content="Crazyfrank&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Crazyfrank&#39;s Blog">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" /><link rel="prev" href="http://localhost:1313/en/posts/understanding-decentralization-through-log-processing/" /><link rel="next" href="http://localhost:1313/en/posts/architecture-design-comment-system/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Cache and DB - Consistency Tradeoffs",
        "inLanguage": "en-US",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/en\/posts\/cache-and-db-consistency-tradeoffs\/"
        },"genre": "posts","keywords": "Caching, System design, Architecture design","wordcount":  1414 ,
        "url": "http:\/\/localhost:1313\/en\/posts\/cache-and-db-consistency-tradeoffs\/","datePublished": "2025-09-11T10:00:00+08:00","dateModified": "2025-09-11T10:00:00+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "crazyfrank"
            },"description": ""
    }
    </script><script src="https://cdn.jsdelivr.net/npm/typeit@8.7.1/dist/index.umd.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><link rel="stylesheet" href="/css/header-links.css">
        <script src="/js/header-links.js"></script>
    </head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="Crazyfrank&#39;s Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/"> Posts </a><a class="menu-item" href="/en/tags/"> Tags </a><a class="menu-item" href="/en/categories/"> Categories </a><a class="menu-item" href="/en/search/"> Search </a><a class="menu-item" href="/zh"> 🇨🇳 中文 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/zh/posts/%E7%BC%93%E5%AD%98%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93--%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E5%8F%96%E8%88%8D/">简体中文</option><option value="/en/posts/cache-and-db-consistency-tradeoffs/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="Crazyfrank&#39;s Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="">Posts</a><a class="menu-item" href="/en/tags/" title="">Tags</a><a class="menu-item" href="/en/categories/" title="">Categories</a><a class="menu-item" href="/en/search/" title="">Search</a><a class="menu-item" href="/zh" title="">🇨🇳 中文</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/zh/posts/%E7%BC%93%E5%AD%98%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93--%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E5%8F%96%E8%88%8D/">简体中文</option><option value="/en/posts/cache-and-db-consistency-tradeoffs/" selected>English</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Cache and DB - Consistency Tradeoffs</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.crazyfrank.top/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>crazyfrank</a></span>&nbsp;<span class="post-category">included in <a href="/en/categories/technology/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Technology</a>&nbsp;<a href="/en/categories/backend/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Backend</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-09-11">2025-09-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1414 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;7 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction-to-concepts">Introduction to Concepts</a></li>
    <li><a href="#bypass-caching">Bypass caching</a>
      <ul>
        <li><a href="#what-if-the-second-step-fails">What if the second step fails?</a></li>
        <li><a href="#writing-dbs-is-also-asynchronous">Writing DBs is also asynchronous</a>
          <ul>
            <li><a href="#compare-and-contrast-the-way-the-two-write-operations-are-designed">Compare and contrast the way the two write operations are designed</a></li>
          </ul>
        </li>
        <li><a href="#can-read-operations-be-asynchronized">Can read operations be asynchronized?</a>
          <ul>
            <li><a href="#what-does-solve">What does solve?</a></li>
            <li><a href="#what-was-introduced-consistency-issues">What was introduced? (consistency issues)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Today we talk about bypass caching strategies.</p>
<h2 id="introduction-to-concepts">Introduction to Concepts</h2>
<p>Generally speaking we introduce caching in our business, which involves three ways of manipulating the database and caching:</p>
<ul>
<li>Read-through:
<ol>
<li>application reads data.</li>
<li>it checks Redis. a hit is returned.</li>
<li>If there is no hit, check MySQL.</li>
<li>Fetch the data from MySQL and write it to Redis.</li>
<li>Return the data.</li>
</ol>
</li>
<li>Write through:
<ol>
<li>The application updates the data.</li>
<li>Code executes simultaneously (or in the same transaction):
<ul>
<li>Update the MySQL database.</li>
<li>Update (or invalidate) the corresponding cache in Redis.</li>
</ul>
</li>
</ol>
</li>
<li>Bypass the cache:
<ul>
<li>Read operations: Use the &ldquo;read-through&rdquo; policy.
<ul>
<li>Cache Hit -&gt; return cached data.</li>
<li>Cache Miss -&gt; Read from DB, backfill Cache and return.</li>
</ul>
</li>
<li>Write operation: first update DB, then delete (invalidate) cache.
<ul>
<li>This is the essence of the &ldquo;bypass cache&rdquo; strategy - &ldquo;update the database first, then delete the cache&rdquo;.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>For read-through from the above introduction can also be seen that it is not used alone, and write-through, there is no middleware support for simultaneous operation of the database, so generally do not use, so the most daily use of the third way: bypass caching!</p>
<h2 id="bypass-caching">Bypass caching</h2>
<p>Specifically why the introduction of bypass cache, you can go to see another article <a href="https://www.crazyfrank.top/en/posts/db-cache-consistency-problem/" target="_blank" rel="noopener noreffer ">DB-Cache consistency issues</a>.</p>
<p>This article focuses on optimization ideas for the classic bypass caching strategy.</p>
<h3 id="what-if-the-second-step-fails">What if the second step fails?</h3>
<p>Once again, we come up with the problem discussed in DB-Cache Consistency.</p>
<p>When exploring various write strategies, the article follows the premise that <code>writing the database and manipulating the cache</code> are all in the same thread, so in order to solve the concurrency problem brought about by the traditional <strong>writing the database first and then writing the cache</strong>, it leads to <strong>deleting the cache</strong> instead of <strong>updating the cache</strong>.
So we introduced <strong>delete cache</strong> instead of <strong>update cache</strong>, and then went on to discuss what to do if the second step fails. In that article, we introduced a way to asynchronize deletion of the cache using a message queue, which ensures the reliability of the operation</p>
<p>Then this way is actually <code>write database, operation cache</code> decoupled, the former synchronous, the latter asynchronous, this design can already achieve strong consistency, but the throughput is still not extreme, the reason is that our write DB is still synchronous.</p>
<p>Is there another way?</p>
<p>Yes, let&rsquo;s look at another design</p>
<h3 id="writing-dbs-is-also-asynchronous">Writing DBs is also asynchronous</h3>
<p>Take a comment system for example.




<div class="lightbox-container">
  <img src="/images/cache-aside/img-1.png" alt="" style="width: 800px; cursor: pointer;" onclick="openLightbox('\/images\/cache-aside\/img-1.png')">
</div>

<div id="lightbox" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; cursor: pointer;" onclick="closeLightbox()">
  <img id="lightbox-img" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90%; max-height: 90%;">
</div>

<script>
function openLightbox(src) {
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox').style.display = 'block';
}
function closeLightbox() {
  document.getElementById('lightbox').style.display = 'none';
}
</script>
</p>
<p>Let&rsquo;s just look at the write operation. In this design, whenever there is a write request, the <code>comment service</code> writes a message to kafka, which is consumed asynchronously by the <code>comment-job</code>, and in the process, it writes to the database and then updates the cache.</p>
<p>Why doesn&rsquo;t it <strong>delete the cache</strong> instead of <strong>update the cache</strong>? Thinking back, why did we introduce <strong>Delete Cache</strong> at that time? Was it to solve the concurrency problem?</p>
<p>The kafka in this architecture, on the other hand, has a partition that naturally supports sequential consumption. What does this mean?</p>
<p>Specifically, when multiple requests operate on the same piece of data, all of them are sent to kafka, and the same piece of data can be sent to the same partition through kafka&rsquo;s hash policy, which is synchronized IO, meaning that their operations are atomic, one by one.
That is to say, their operations are atomic, one by one, so there is a natural guarantee that there will be no concurrency problems.</p>
<p>It&rsquo;s the fact that it&rsquo;s <code>writing the database and manipulating the cache</code> in the same thread, combined with kafka&rsquo;s sequential consumption, that ensures that concurrency issues don&rsquo;t arise.</p>
<h4 id="compare-and-contrast-the-way-the-two-write-operations-are-designed">Compare and contrast the way the two write operations are designed</h4>
<ol>
<li>Data consistency
<ul>
<li>Scenario A:
<ul>
<li>The DB is updated synchronously, so as long as the DB succeeds, the data will not be lost.</li>
<li>Cache is deleted asynchronously, there may be short-lived old data, but the next read request will trigger back to the source and eventually be consistent.</li>
<li>Suitable for: Scenarios with high requirements for strong DB data consistency (e.g. orders, payments).</li>
</ul>
</li>
<li>Scenario B:
<ul>
<li>Both DB and cache are updated asynchronously, and both may be transiently inconsistent in the event of a Kafka message backlog or consumption failure.</li>
<li>Ideal for: scenarios that allow for eventual consistency (e.g., social comments, dynamics).</li>
</ul>
</li>
</ul>
</li>
<li>Performance and Throughput
<ul>
<li>Scenario A:
<ul>
<li>The service layer still needs to write DB synchronously and DB is still the bottleneck.</li>
<li>However, caching operations are asynchronized to alleviate some of the pressure.</li>
</ul>
</li>
<li>Scenario B:
<ul>
<li>Option B: All asynchronous, the service layer only needs to write Kafka, throughput is very high.</li>
<li>It is suitable for highly concurrent writing scenarios (such as microblog comments and chat messages).</li>
</ul>
</li>
</ul>
</li>
<li>Caching strategy differences
<ul>
<li>Scenario A (Delete Cache):
<ul>
<li>Advantage: Avoid cache pollution, ensure that the next read request back to the source of the latest data.</li>
<li>Disadvantage: May cause a cache hit (a large number of requests back to the source DB at the same time).</li>
</ul>
</li>
<li>Scenario B (directly update the cache): Advantage: the cache always has data:
<ul>
<li>Option B (Update the cache directly): Advantage: The cache always has data, reducing the pressure on the source DB.</li>
<li>Disadvantage: If Kafka consumption is delayed, the cache may hold old data for a short time.</li>
</ul>
</li>
</ul>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th>Scenarios</th>
          <th>Recommended Scenarios</th>
          <th>Reasons</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Read more, write less, strong consistency requirements (e.g., orders, accounts)</td>
          <td>Scenario A (synchronous write DB + asynchronous delete cache)</td>
          <td>Ensure DB strong consistency, cache eventually consistent</td>
      </tr>
      <tr>
          <td>Write more read less, high throughput (e.g., comments, dynamics)</td>
          <td>Scenario B (fully asynchronous Kafka write DB + cache)</td>
          <td>Maximize write performance, allow for short-lived inconsistencies</td>
      </tr>
      <tr>
          <td>Ultra-high concurrency, acceptable latency (e.g., hotlisting)</td>
          <td>Scenario B + local cache</td>
          <td>Further reduce DB stress</td>
      </tr>
  </tbody>
</table>
<h3 id="can-read-operations-be-asynchronized">Can read operations be asynchronized?</h3>
<p>According to the classic Cache-Aside pattern, reading back to the source (Loading Data on Cache Miss) must be synchronous.</p>
<p>It seeks to complete data fetching within the lifecycle of a single request, ensuring that this request returns the most accurate data possible.</p>
<p>Why is synchronized readback required?</p>
<p>The purpose is to solve the consistency problem. Synchronized back to the source can ensure:</p>
<ol>
<li>Consistency of the data returned by this request: when a cache miss occurs, the client needs to wait for that synchronization operation to complete to ensure that it is getting the most recent data in the current database (assuming that no other concurrent write operations interfere). If the return is asynchronous, the request will either fail to return data or return a null or error, which is generally unacceptable. 2.</li>
<li>Avoiding &ldquo;return storms&rdquo;: A key technique for synchronizing returns is the use of Mutex Locks. When multiple concurrent requests find out that the same key cache is invalid, only one request gets the lock to query the database and back to the source cache synchronously, while the others wait for the lock to be released and then read directly from the newly populated cache. This avoids multiple requests trying to hit the database at the same time.</li>
</ol>
<p>But with the design in the diagram you can actually see that our return to source is also <strong>asynchronous</strong>.</p>
<p>Asynchronous back-origin via Kafka is an optimization and compromise to the classic pattern. It solves some of the pain points of the classic pattern, but it also introduces new features.</p>
<h4 id="what-does-solve">What does solve?</h4>
<ul>
<li><strong>Reduced read request latency</strong>: the server doesn&rsquo;t have to wait for the cache write to complete. As long as the data is checked from the database, it can be returned to the client immediately, and the cache update is handed over to the background for asynchronous processing, which significantly improves the interface response speed.</li>
<li><strong>Simplified server-side logic</strong>: the server does not need to deal with complex cache write logic and locking mechanism, the code is more concise.</li>
<li><strong>Merge Write</strong>: Multiple updates to the same data can be merged in the asynchronous message queue to reduce the pressure of writing to the cache.</li>
</ul>
<h4 id="what-was-introduced-consistency-issues">What was introduced? (consistency issues)</h4>
<ul>
<li><strong>Transient data inconsistency</strong>: old data (or no data) remains in the cache until an asynchronous message is processed. Subsequent read requests will read the old data until the cache is invalidated.</li>
<li><strong>Possible data loss</strong>: If a Kafka message is lost or consumption fails, the cache remains in an unreturned state until the next write operation triggers an update or the cache naturally expires.</li>
</ul>
<p>However, this design is a <strong>reasonable tradeoff</strong>, for commenting systems, users see their own or others&rsquo; comments updated a few milliseconds or seconds late, which is usually an acceptable business scenario.
Trading this small price for a significant increase in system throughput and responsiveness is a very worthwhile architectural decision.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-09-11</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-title="Cache and DB - Consistency Tradeoffs" data-hashtags="Caching,System design,Architecture design"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-hashtag="Caching"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-title="Cache and DB - Consistency Tradeoffs"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-title="Cache and DB - Consistency Tradeoffs"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-title="Cache and DB - Consistency Tradeoffs"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/en/posts/cache-and-db-consistency-tradeoffs/" data-title="Cache and DB - Consistency Tradeoffs" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fen%2fposts%2fcache-and-db-consistency-tradeoffs%2f&amp;text=Cache%20and%20DB%20-%20Consistency%20Tradeoffs" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/en/tags/caching/">Caching</a>,&nbsp;<a href="/en/tags/system-design/">System Design</a>,&nbsp;<a href="/en/tags/architecture-design/">Architecture Design</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/posts/understanding-decentralization-through-log-processing/" class="prev" rel="prev" title="Understanding Decentralization Through Log Processing"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Understanding Decentralization Through Log Processing</a>
            <a href="/en/posts/architecture-design-comment-system/" class="next" rel="next" title="Architecture Design-Comment System">Architecture Design-Comment System<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.148.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.crazyfrank.top/" target="_blank">crazyfrank</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script>window.config={"search":{"maxResultLength":10,"snippetLength":30,"highlightTag":"em","noResultsFound":"没有找到结果"},"toc":{"enable":true,"auto":true}};</script>

<script>
window.ClipboardJS = function(element) {
  this.element = element;
  this.callbacks = {};
  element.addEventListener('click', () => {
    const text = element.getAttribute('data-clipboard-text');
    navigator.clipboard.writeText(text).then(() => {
      if (this.callbacks.success) this.callbacks.success();
    });
  });
};
window.ClipboardJS.prototype.on = function(event, callback) {
  this.callbacks[event] = callback;
};
</script>

<script src="/js/theme.js"></script>

<script>

document.addEventListener('DOMContentLoaded', function() {
  setTimeout(function() {
    document.querySelectorAll('.details.admonition').forEach(function(details) {
      const summary = details.querySelector('.details-summary');
      if (summary) {
        summary.addEventListener('click', function() {
          details.classList.toggle('open');
        });
      }
    });
  }, 300);
});
</script>

<script>

setTimeout(function() {
  document.querySelectorAll('.code-block').forEach(function(codeBlock) {
    const codeTitle = codeBlock.querySelector('.code-header > .code-title');
    const copyBtn = codeBlock.querySelector('.code-header .copy');
    
    if (codeTitle && !codeTitle.hasAttribute('data-cb-init')) {
      codeTitle.setAttribute('data-cb-init', 'true');
      codeTitle.addEventListener('click', function() {
        codeBlock.classList.toggle('open');
      });
    }
    
    if (copyBtn && !copyBtn.hasAttribute('data-cb-init')) {
      copyBtn.setAttribute('data-cb-init', 'true');
      const code = codeBlock.querySelector('code');
      if (code) {
        copyBtn.addEventListener('click', function() {
          navigator.clipboard.writeText(code.innerText).then(function() {
            const codeLines = code.querySelectorAll('span.cl');
            if (codeLines.length > 0) {
              codeLines.forEach(function(codeLine) {
                codeLine.classList.add('animate__animated', 'animate__flash');
                setTimeout(function() {
                  codeLine.classList.remove('animate__animated', 'animate__flash');
                }, 1000);
              });
            }
          });
        });
      }
    }
  });
}, 500);
</script>

<style>
.menu-item.language {
  display: none !important;
}
#language-select-desktop {
  display: none !important;
}
.search-form,
#search-input,
.search-loading,
.search-results {
  text-align: center !important;
}
</style>

<script>
const originalFetch = window.fetch;
window.fetch = function(url, options) {
  if (window.location.pathname.startsWith('/en/') && url === '/zh/index.json') {
    url = '/en/index.json';
  }
  return originalFetch(url, options);
};

const originalOpen = XMLHttpRequest.prototype.open;
XMLHttpRequest.prototype.open = function(method, url, ...args) {
  if (window.location.pathname.startsWith('/en/') && url === '/zh/index.json') {
    url = '/en/index.json';
  }
  return originalOpen.call(this, method, url, ...args);
};

document.addEventListener('DOMContentLoaded', function() {
  if (window.location.pathname.includes('/search/')) {
    const title = document.querySelector('h2');
    if (title) {
      title.style.cssText = `
        text-align: center !important;
        margin-top: 120px !important;
        margin-bottom: 60px !important;
        padding-top: 50px !important;
      `;
    }
  }
});
</script>
<script>
        setTimeout(function() {
            
            const content = {
                title: "Crazyfrank\u0027s Blog",
                subtitle: "Adversity reveals true strength"
            };
            
            
            document.querySelectorAll('.typeit').forEach(function(element) {
                if (element.id) {
                    let text = '';
                    if (element.id === 'id-1' || element.id === 'id-2') {
                        text = content.title;
                    } else if (element.id === 'id-3') {
                        text = content.subtitle;
                    }
                    
                    if (text) {
                        new TypeIt('#' + element.id, {
                            strings: text,
                            speed: 100,
                            waitUntilVisible: true
                        }).go();
                    }
                }
            });
        }, 600);
        </script>
    </body>
</html>
